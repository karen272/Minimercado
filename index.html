<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Pochoclos "La 22"</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/logo.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/drift-zoom/drift-basic.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">
</head>

<body class="index-page">

  <header id="header" class="header sticky-top">
    <!-- Main Header -->
    <div class="main-header">
      <div class="container-fluid container-xl">
        <div class="d-flex py-3 align-items-center justify-content-between">
          <!-- Logo -->
          <a href="index.html" class="logo d-flex align-items-center">
            <img src="assets/img/logo.png" alt="">
            <h1 class="sitename">Pochoclos "La 22"</h1>
          </a>

          <!-- Actions -->
          <div class="header-actions d-flex align-items-center justify-content-end">
            <!-- Cart -->
            <a href="cart.html" class="header-action-btn">
              <i class="bi bi-cart3"></i>
              <span class="badge cart-count">0</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="main">

    <!-- Hero Section -->
    <section id="hero" class="hero section">
      <div class="hero-container">
        <div class="hero-content">
          <div class="content-wrapper" data-aos="fade-up" data-aos-delay="100">
            <h1 class="hero-title">Minimercado Los 3 nenes</h1>
            <p class="hero-description">Te los llevamos a tu casa!</p>
            <div class="hero-actions" data-aos="fade-up" data-aos-delay="200">
              <a href="#best-sellers" class="btn-primary">Comprá ahora</a>
            </div>
            <div class="features-list" data-aos="fade-up" data-aos-delay="300">
              <div class="feature-item">
                <i class="bi bi-truck"></i>
                <span>Envio gratis</span>
              </div>
              <div class="feature-item">
                <i class="bi bi-award"></i>
                <span>Garantía de calidad</span>
              </div>
            </div>
          </div>
        </div>

        <div class="hero-visuals">
          <div class="product-showcase" data-aos="fade-left" data-aos-delay="200">
            <div class="product-card featured">
              <img src="assets/img/img12.jpg" alt="Featured Product" class="img-fluid">
              <div class="product-badge">Los más pedidos</div>
              <div class="product-info">
                <h4>Pochoclos dulces</h4>
                <div class="price">
                  <span class="sale-price">$3.000</span>
                  <span class="original-price">$4.500</span>
                </div>
              </div>
            </div>
          </div>

          <div class="floating-elements">
            <div class="floating-icon cart" data-aos="fade-up" data-aos-delay="600">
              <i class="bi bi-cart3"></i>
              <span class="notification-dot cart-count">0</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Best Sellers Section -->
    <section id="best-sellers" class="best-sellers section">
      <div class="container section-title" data-aos="fade-up">
        <h2>Productos</h2>
        <p>Los mejores de la costa Argentina</p>
      </div>

      <div class="container" data-aos="fade-up" data-aos-delay="100">
        <div id="products-container" class="row g-5">
          <div class="col-12 text-center">
            <p>Cargando productos...</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Sección Eventos -->
    <section class="best-sellers section">
      <div class="container section-title" data-aos="fade-up">
        <h2>Eventos</h2>
        <p>Los mejores precios para tu evento! Contanos brevemente de qué se trata tu evento y te contactamos.</p>
      </div>

      <div class="col-lg-6 col-md-8 mx-auto">
        <div class="event-item p-4 shadow rounded">
          <div class="event-form">
            <div class="mb-3">
              <label for="eventName" class="form-label">Tu nombre</label>
              <input type="text" id="eventName" class="form-control" placeholder="Ej: Karen">
            </div>
            <div class="mb-3">
              <label for="eventMsg" class="form-label">Sobre tu evento</label>
              <textarea id="eventMsg" class="form-control" rows="3" placeholder="Ej: Cumpleaños de 15, 40 invitados"></textarea>
            </div>
            <button class="btn btn-rojo w-100" onclick="enviarEventoWhatsApp()">
              Consultar por WhatsApp
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Sección Encontranos en -->
    <div class="container section-title" data-aos="fade-up">
      <h2>Encontranos en</h2>
      <p>Calle 21 esquina 22</p>
      <section class="best-sellers section">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3132.361799696248!2d-57.83911693724126!3d-38.271105241265474!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x95851062d159d1c9%3A0x9511f33fbd2a3f48!2sC.%2022%20%26%20C.%2021%2C%20Miramar%2C%20Provincia%20de%20Buenos%20Aires!5e0!3m2!1ses-419!2sar!4v1669685770329!5m2!1ses-419!2sar"
          width="400" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </section>
    </div>

  </main>

  <footer id="footer" class="footer dark-background">
    <div class="footer-main">
      <div class="container">
        <div class="row gy-4">
          <div class="col-lg-4 col-md-6">
            <div class="footer-widget footer-about">
              <a href="index.html" class="logo">
                <span class="sitename">Pochoclos "La 22"</span>
              </a>
              <div class="social-links mt-4">
                <h5>Contactate con nosotros</h5>
                <div class="social-icons">
                  <a href="https://www.instagram.com/pochoclosla22/" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <div class="footer-widget">
              <h4>Información de contacto</h4>
              <div class="footer-contact">
                <div class="contact-item">
                  <i class="bi bi-geo-alt"></i>
                  <span>Calle 21 esquina 22, Miramar, Buenos Aires, Argentina</span>
                </div>
                <div class="contact-item">
                  <i class="bi bi-telephone"></i>
                  <span>+54 (2291) 459738</span>
                </div>
                <div class="contact-item">
                  <i class="bi bi-envelope"></i>
                  <span>karenceles10@gmail.com</span>
                </div>
                <div class="contact-item">
                  <i class="bi bi-clock"></i>
                  <span>Atención 24/7 todos los días</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container">
        <div class="row gy-3 align-items-center">
          <div class="col-lg-6 col-md-12">
            <div class="copyright">
              <p>© <span>Copyright</span> <strong class="sitename">PochocleraLa22</strong>. Todos los derechos reservados</p>
            </div>
            <div class="credits mt-1">
              Diseñado por <a href="https://api.whatsapp.com/send?phone=5492291459738&text=Hola!%20me%20interesa%20hacer%20una%20página%20web%20como%20la%20de%20PochoclosLa22">Karen Celes</a>
            </div>
          </div>
          <div class="col-lg-6 col-md-12">
            <div class="d-flex flex-wrap justify-content-lg-end justify-content-center align-items-center gap-4">
              <div class="payment-methods">
                <div class="payment-icons">
                  <i class="bi bi-paypal" aria-label="PayPal"></i>
                  <i class="bi bi-cash" aria-label="Cash on Delivery"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/drift-zoom/Drift.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.20.0"></script>

  <!-- Main JS Files -->
  <script src="assets/js/main.js"></script>
  <script src="assets/js/carrito.js"></script>

  <!-- Modal Agregado al Carrito -->
  <div class="modal fade" id="cartModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-3 border-0 shadow">
        <div class="modal-header">
          <h5 class="modal-title">✅ Producto agregado</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body text-center">
          <p id="cartModalMessage" class="mb-3"></p>
          <div class="d-flex justify-content-center gap-3">
            <button class="btn btn-outline-primary" data-bs-dismiss="modal">Seguir comprando</button>
            <a href="cart.html" class="btn btn-primary">Ver carrito</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Validación -->
  <div class="modal fade" id="validationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-3 border-0 shadow">
        <div class="modal-header bg-pink text-white">
          <h5 class="modal-title text-white">⚠️ Atención</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body text-center">
          <p id="validationMessage" class="mb-3"></p>
          <div class="d-flex justify-content-center">
            <button class="btn btn-pink" data-bs-dismiss="modal">Aceptar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Script principal -->
  <script>
    // Verificar si Supabase se cargó
    if (!window.supabase) {
      console.error('❌ Supabase no se cargó');
      alert('Error: Supabase no está disponible.');
      throw new Error('Supabase no cargado');
    }

    // Inicializar Supabase
    const supabaseClient = window.supabase.createClient(
      'https://ojwgjqccvfxwljyhcipa.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9qd2dqcWNjdmZ4d2xqeWhjaXBhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxMTE0NDIsImV4cCI6MjA3MjY4NzQ0Mn0.XYv1t0vFLJ1R4ZnazHec-7c5spTIFHNAKgnbHtdnOrU'
    );

    // Cargar productos cuando el DOM esté listo
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const { data, error } = await supabaseClient.from('products').select('*');

        if (error) {
          console.error('❌ Error al cargar productos:', error);
          document.getElementById('products-container').innerHTML = `
            <div class="col-12 text-center">
              <p class="text-danger">Error al cargar productos.</p>
            </div>`;
          return;
        }

        if (!data || !Array.isArray(data)) {
          console.error('❌ No se recibieron productos válidos');
          return;
        }

        const container = document.getElementById('products-container');
        container.innerHTML = '';

        data.forEach(p => {
          const col = document.createElement('div');
          col.className = 'col-lg-3 col-md-6';
          col.innerHTML = `
            <div class="product-item">
              <div class="product-image">
                <img src="${p.image_url || 'assets/img/product/default.png'}" 
                     alt="${p.name}" 
                     class="img-fluid" 
                     loading="lazy">
                <button 
                  class="cart-btn" 
                  data-id="${p.id}" 
                  data-name="${p.name}" 
                  data-price="${p.price}" 
                  data-img="${p.image_url || 'assets/img/product/default.png'}">
                  Agregar al carrito
                </button>
              </div>
              <div class="product-info">
                <h4 class="product-name">${p.name}</h4>
                <div class="product-price">$${new Intl.NumberFormat('es-AR').format(p.price)}</div>
              </div>
            </div>`;
          container.appendChild(col);
        });

        // ✅ Event delegation: escucha clicks en el contenedor
        container.addEventListener('click', (e) => {
          const btn = e.target.closest('.cart-btn');
          if (!btn) return;

          const producto = {
            id: btn.dataset.id,
            nombre: btn.dataset.name,
            precio: parseFloat(btn.dataset.price),
            img: btn.dataset.img,
            cantidad: 1
          };

          agregarAlCarrito(producto);

          const modalMessage = document.getElementById("cartModalMessage");
          modalMessage.textContent = `${producto.nombre} agregado al carrito ✅`;

          const cartModal = new bootstrap.Modal(document.getElementById("cartModal"));
          cartModal.show();
        });

      } catch (err) {
        console.error('❌ Error inesperado:', err);
        document.getElementById('products-container').innerHTML = `
          <div class="col-12 text-center">
            <p class="text-danger">No se pudieron cargar los productos.</p>
          </div>`;
      }
    });
  </script>

</body>
</html>